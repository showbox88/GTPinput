# GTPinput ğŸ’°
**GPT æ™ºèƒ½è®°è´¦ç³»ç»Ÿ V3.0**

è¿™æ˜¯ä¸€ä¸ªç”± GPT é©±åŠ¨çš„ä¸ªäººè®°è´¦å…¨æ ˆç³»ç»Ÿï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€è®°è´¦ã€è‡ªåŠ¨åˆ†ç±»ã€å®æ—¶æ±‡æ€»ã€è‡ªåŠ¨å‘¨æœŸæ‰£æ¬¾ã€æœˆåº¦é¢„ç®—ç®¡ç†ï¼Œå¹¶é€šè¿‡ Streamlit æä¾›æ‰‹æœº/ç”µè„‘å‹å¥½çš„å¯è§†åŒ– Dashboardã€‚

**æœ€æ–°æ¶æ„ (v3.0)**ï¼š
- **è®°è´¦**: Streamlit Chat UI (è¾“å…¥) â†’ OpenAI (è§£æ) â†’ Cloudflare Worker (API) â†’ D1 Database
- **æ–‡æ¡£**: Streamlit File Uploader â†’ OpenAI (è¯†å›¾) â†’ Google Drive/Sheets/Calendar (å½’æ¡£)

---

## âœ¨ V3.0 æ–°ç‰¹æ€§

### 1. ğŸ“… æœˆåº¦é¢„ç®—ç®¡ç† (Monthly Budgets)
- **è‡ªåŠ¨è½®è½¬**ï¼šé¢„ç®—è¿›åº¦æŒ‰æœˆè‡ªåŠ¨é‡ç½®ã€‚
- **å¯è§†åŒ–è¿›åº¦æ¡**ï¼šè‡ªå®šä¹‰ CSS å®ç°çš„é«˜é¢œå€¼è¿›åº¦æ¡ï¼Œæ”¯æŒæ˜äº®/æš—é»‘åŒæ¨¡å¼ã€‚
- **å›¾æ ‡é˜µåˆ—**ï¼š10x4 äº¤äº’å¼ Emoji é€‰æ‹©é¢æ¿ï¼Œè®©æ¯ä¸ªåˆ†ç±»éƒ½ä¸ªæ€§åè¶³ã€‚

### 2. ğŸ”„ è‡ªåŠ¨å‘¨æœŸæ‰£æ¬¾ (Recurring Expenses)
- **å›ºå®šå¼€é”€è‡ªåŠ¨åŒ–**ï¼šæ”¯æŒâ€œæˆ¿ç§Ÿâ€ã€â€œè®¢é˜…è´¹â€ç­‰å›ºå®šæ”¯å‡ºçš„è‡ªåŠ¨è®°å½•ã€‚
- **Cron è§¦å‘**ï¼šåŸºäº Cloudflare Cron Triggersï¼Œæ¯å¤©è‡ªåŠ¨æ£€æŸ¥å¹¶ç”Ÿæˆè´¦å•ã€‚
- **çµæ´»é…ç½®**ï¼šæ”¯æŒæŒ‰å‘¨ã€æŒ‰æœˆã€æŒ‰å¹´è®¾ç½®è§„åˆ™ï¼ˆå¦‚â€œæ¯æœˆ 1 æ—¥â€ã€â€œæ¯å‘¨äº”â€ï¼‰ã€‚

### 3. ğŸ¤– GPT èƒ½åŠ›å‡çº§ (Custom GPT Actions)
- **ä¸ä»…æ˜¯è®°å½•**ï¼šç°åœ¨èµ‹äºˆäº† GPT **åˆ é™¤**å’Œ**ä¿®æ”¹**è®°å½•çš„æƒé™ã€‚
- **è‡ªç„¶è¯­è¨€æ“ä½œ**ï¼š
    - "æŠŠæ˜¨å¤©é‚£ç¬”æ‰“è½¦è´¹åˆ äº†"
    - "æˆ¿ç§Ÿé‡‘é¢æ”¹æˆ 2600"
    - "æŸ¥ä¸€ä¸‹ä¸Šå‘¨åƒé¥­èŠ±äº†å¤šå°‘"

### 4. âœ… æ™ºèƒ½äº¤äº’åŠ©æ‰‹ (New)
- **è®°è´¦**: "åˆé¥­ 30"
- **æŸ¥è¯¢**: "ä¸Šä¸ªæœˆèŠ±äº†å¤šå°‘ï¼Ÿ", "æŸ¥ä¸€ä¸‹ä¹°æ°´æœçš„è®°å½•"
- **åˆ é™¤**: "åˆ é™¤ä¸Šä¸€æ¡", "åˆ é™¤ä¹°çƒŸçš„è®°å½•"

### 5. âœ… æ™ºèƒ½æ–‡æ¡£å½’æ¡£ (New)
- **é›†æˆ SmartDoc æ ¸å¿ƒå¼•æ“**ï¼šä¸Šä¼ å‘ç¥¨/è¯ä»¶ç…§ç‰‡ï¼Œè‡ªåŠ¨è¯†åˆ«å¹¶ä¸Šä¼ è‡³ Google Driveï¼Œå†™å…¥ Google Sheets å’Œ Calendarã€‚

### 6. âœ… æ”¶æ®è‡ªåŠ¨è®°è´¦ (New)
- **è‡ªåŠ¨æå–**ï¼šä¸Šä¼ æ”¶æ®å›¾ç‰‡æ—¶ï¼Œè‡ªåŠ¨æå–é‡‘é¢å¹¶è®°å…¥è´¦æœ¬ã€‚

### 7. âœ… æ ¸å¿ƒç³»ç»Ÿå‡çº§
- **API é©±åŠ¨**ï¼šä½¿ç”¨ Cloudflare Worker + D1ï¼Œå“åº”é€Ÿåº¦æå¿«ã€‚
- **å…¨åŠŸèƒ½ä»ªè¡¨ç›˜**ï¼š
    - **KPI æ¦‚è§ˆ**ï¼šæœ¬æœˆ/ä»Šå¹´æ”¯å‡ºã€ç­›é€‰åˆè®¡ã€è®°å½•ç¬”æ•°ã€‚
    - **å¯è§†åŒ–å›¾è¡¨**ï¼šæœˆåº¦è¶‹åŠ¿æŸ±çŠ¶å›¾ã€åˆ†ç±»å æ¯”é¥¼å›¾ã€‚
    - **äº¤äº’å¼è¡¨æ ¼**ï¼šæ”¯æŒæŒ‰æœˆ/åˆ†ç±»ç­›é€‰ã€‚
- **ğŸ“¸ ç§»åŠ¨ç«¯ç›¸æœºæ”¯æŒ (New)**ï¼š
    - é›†æˆç½‘é¡µç‰ˆç›¸æœºï¼Œæ”¯æŒæ‰‹æœºç«¯ç›´æ¥æ‹ç…§ä¸Šä¼ ã€‚
    - è‡ªåŠ¨åˆ¤æ–­æ–‡ä»¶æ¥æºï¼ˆç›¸å†Œ/ç›¸æœºï¼‰è¿›è¡Œæ™ºèƒ½åˆ†ç±»ã€‚
- **ğŸ¨ ä¸“ä¸šçº§ UI è®¾è®¡ (New)**ï¼š
    - **Deep Blue Theme**ï¼šæ·±è“æå®¢é£æ ¼ç•Œé¢ï¼ŒæŠ¤çœ¼ä¸”ä¸“ä¸šã€‚
    - **æ™ºèƒ½äº¤äº’è®¾è®¡**ï¼šå·¦ä¾§å¯¹é½çš„æ²‰æµ¸å¼å¯¹è¯ä½“éªŒã€‚
    - **åŠ¨æ€å¤´åƒ**ï¼šé›†æˆ Dicebear é«˜æ¸…çŸ¢é‡å¤´åƒ (æœºå™¨äºº ğŸ¤– vs ç”¨æˆ· ğŸ§‘)ã€‚
- **æ•°æ®ç®¡ç†èƒ½åŠ›**ï¼š
    - **ç¼–è¾‘**ï¼šç›´æ¥åœ¨è¡¨æ ¼ä¸­ä¿®æ”¹é‡‘é¢ã€åˆ†ç±»ã€æ—¥æœŸç­‰ã€‚
    - **åˆ é™¤**ï¼šæ”¯æŒå‹¾é€‰å¤šæ¡è®°å½•ä¸€é”®åˆ é™¤ã€‚
    - **æ¸…ç©º**ï¼šæä¾›â€œDanger Zoneâ€ä¸€é”®æ¸…ç©ºæ‰€æœ‰æ•°æ®åŠŸèƒ½ã€‚

### 8. ğŸš€ V3.1 ä½“éªŒå‡çº§ (Updates)
- **ğŸ” ä¿æŒç™»å½• (Persistent Login)**: æ”¯æŒ "Remember Me" é€‰é¡¹ï¼Œè‡ªåŠ¨ç¼“å­˜ä¼šè¯ï¼Œå…å»é‡å¤ç™»å½•çƒ¦æ¼ã€‚
- **ğŸ”„ æ‰‹åŠ¨åˆ·æ–° (Manual Refresh)**: ä»ªè¡¨ç›˜æ–°å¢åˆ·æ–°æŒ‰é’®ï¼Œä¸€é”®åŒæ­¥æœ€æ–°æ•°æ®ã€‚
- **âœ¨ äº¤äº’ä¼˜åŒ–**:
    - å…¨æ–° "Thinking..." æ€è€ƒåŠ¨ç”» (å…‰ç¯ç‰¹æ•ˆ)ã€‚
    - ç™»å½•ç•Œé¢æ”¯æŒå›è½¦é”®æäº¤ã€‚
    - è®°å½•åˆ—è¡¨æŒ‰ "æ—¥æœŸ + å½•å…¥é¡ºåº" æ™ºèƒ½æ’åºã€‚

    - è®°å½•åˆ—è¡¨æŒ‰ "æ—¥æœŸ + å½•å…¥é¡ºåº" æ™ºèƒ½æ’åºã€‚

### 9. ğŸ“ æ™ºèƒ½å¤‡æ³¨ç³»ç»Ÿ (New)
ç³»ç»Ÿé€šè¿‡ä¸“å±å›¾æ ‡è‡ªåŠ¨æ ‡è¯†è®°å½•æ¥æºï¼Œä¸€ç›®äº†ç„¶ï¼š
- ğŸ’¬ **App åŠ©æ‰‹**ï¼šç½‘é¡µ/æ‰‹æœºç«¯ç›´æ¥å¯¹è¯å½•å…¥ï¼ˆå¦‚ `ğŸ’¬ åˆé¥­ 20`ï¼‰ã€‚
- ğŸ¤– **å®šåˆ¶ GPT**ï¼šé€šè¿‡å¤–éƒ¨ GPTs / API è°ƒç”¨å½•å…¥ï¼ˆå¦‚ `ğŸ¤– å¤–éƒ¨GPTè®°å½•`ï¼‰ã€‚
- ğŸ”„ **è‡ªåŠ¨è®¢é˜…**ï¼šç³»ç»Ÿè‡ªåŠ¨æ‰£æ¬¾ç”Ÿæˆçš„è®°å½•ï¼ˆå¦‚ `ğŸ”„ è‡ªåŠ¨è®¢é˜…`ï¼‰ã€‚

### 10. ğŸš€ V3.2 æœ€æ–°æ›´æ–° (Latest)
- **ğŸ“± å“åº”å¼å¸ƒå±€ (Responsive Layout)**: é¡µé¢ç°åœ¨è‡ªåŠ¨é€‚åº”å®½å±æ˜¾ç¤ºå™¨å’Œæ‰‹æœºå±å¹•ï¼Œè§†è§‰ä½“éªŒæ›´ä½³ã€‚
- **ğŸ”„ å¢å¼ºçš„è®¢é˜…ç®¡ç†**:
    - æ–°å¢ **Weekly (æ¯å‘¨)** æ‰£æ¬¾å‘¨æœŸæ”¯æŒã€‚
    - æ›´åŠ ç›´è§‚çš„æ—¥æœŸé€‰æ‹©å™¨ (Calendar Date Picker)ã€‚
    - æ™ºèƒ½æ˜¾ç¤ºä¸‹æ¬¡æ‰£æ¬¾è§„åˆ™ (å¦‚ "æ¯å‘¨äº”" æˆ– "æ¯æœˆ25æ—¥")ã€‚
- **ğŸ—‘ï¸ ä¾¿æ·åˆ é™¤åŠŸèƒ½**:
    - åœ¨â€œé¢„ç®—ç®¡ç†â€å’Œâ€œè®¢é˜…ç®¡ç†â€ä¸­æ–°å¢äº†ç‹¬ç«‹çš„ **åˆ é™¤ (Delete)** å‹¾é€‰æ¡†ã€‚
    - å‹¾é€‰åä¿å­˜å³å¯åˆ é™¤ï¼Œæ“ä½œæ›´å®‰å…¨ã€ç›´è§‚ã€‚

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„

```mermaid
graph TD
    User(ç”¨æˆ·/GPT) -->|è¯­éŸ³/æ–‡å­—| API(Cloudflare Worker)
    Cron(Cron Trigger) -->|æ¯æ—¥è§¦å‘| API
    
    API -->|SQL| DB[(Cloudflare D1 SQLite)]
    
    Streamlit(Streamlit Dashboard) -->|GET /list| API
    Streamlit -->|POST /update| API
    Streamlit -->|POST /delete| API
    
    API -->|JSON| Streamlit
```

---

## ğŸ› ï¸ API æ¥å£ (Cloudflare Worker)

æ‰€æœ‰æ“ä½œå‡éœ€ `X-API-Key` é‰´æƒã€‚

### æ ¸å¿ƒè®°è´¦
| æ–¹æ³• | è·¯å¾„ | æè¿° |
|---|---|---|
| `POST` | `/add` | è‡ªç„¶è¯­è¨€è®°è´¦ (GPT è§£æ) |
| `GET` | `/list` | è·å–æœ€è¿‘è®°å½• |
| `POST` | `/update` | **[NEW]** ä¿®æ”¹è®°å½• (ID) |
| `POST` | `/delete` | **[NEW]** åˆ é™¤è®°å½• (ID) |

### é¢„ç®—ä¸å‘¨æœŸ
| æ–¹æ³• | è·¯å¾„ | æè¿° |
|---|---|---|
| `GET` | `/budget/list` | è·å–é¢„ç®—åˆ—è¡¨ |
| `POST` | `/budget/add` | æ–°å¢é¢„ç®— |
| `POST` | `/budget/delete` | åˆ é™¤é¢„ç®— |
| `GET` | `/recurring/list` | è·å–å›ºå®šè§„åˆ™åˆ—è¡¨ |
| `POST` | `/recurring/add` | æ–°å¢è§„åˆ™ |
| `GET` | `/recurring/check` | æ‰‹åŠ¨è§¦å‘è§„åˆ™æ£€æŸ¥ |

---

## ğŸ“‚ æ–‡ä»¶ç»“æ„ (File Structure)

```text
.
â”œâ”€â”€ .streamlit/          # Streamlit é…ç½® (secrets.toml, config.toml)
â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶ (rules.py, settings.json)
â”œâ”€â”€ docs/                # é¡¹ç›®æ–‡æ¡£ (tasks, plans)
â”œâ”€â”€ supabase/            # Supabase ç›¸å…³ (Edge Functions)
â”‚   â””â”€â”€ functions/
â”‚       â””â”€â”€ gpt-api/     # æ ¸å¿ƒ API (Cloudflare Worker/Supabase Edge Function)
â”œâ”€â”€ scripts/             # è‡ªåŠ¨åŒ–è„šæœ¬
â”‚   â””â”€â”€ cron_job.py      # å›ºå®šæ”¯å‡ºæ£€æŸ¥è„šæœ¬ (GitHub Action)
â”œâ”€â”€ .github/workflows/   # GitHub Actions é…ç½®
â”‚   â””â”€â”€ daily_check.yml  # å®šæ—¶ä»»åŠ¡å·¥ä½œæµ
â”œâ”€â”€ app.py               # Streamlit ä¸»ç¨‹åº (Frontend)
â”œâ”€â”€ expense_chat.py      # æœ¬åœ°å¯¹è¯é€»è¾‘å¤„ç†
â”œâ”€â”€ openapi_supabase.json # OpenAI Actions å®šä¹‰
â”œâ”€â”€ requirements.txt     # Python ä¾èµ–
â””â”€â”€ supabase_setup.sql   # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
```

---

## ğŸ–¥ï¸ éƒ¨ç½²æŒ‡å—

### 1. Supabase / Cloudflare Worker (åç«¯)
éœ€è¦ç»‘å®š D1 æ•°æ®åº“ (`expense_db`) å’Œè®¾ç½® `APP_API_KEY` / `OPENAPI_API_KEY` ç¯å¢ƒå˜é‡ã€‚

**å…³é”®é…ç½® (wrangler.toml / supabase/config.toml)**:
```toml
[[d1_databases]]
binding = "expense_db"
database_name = "expense-db"
database_id = "your-id"

[triggers]
crons = ["0 0 * * *"] # æ¯å¤©åˆå¤œè§¦å‘

### 2. GitHub Actions (è‡ªåŠ¨æ‰£æ¬¾)
é¡¹ç›®åŒ…å« `Daily Recurring Check` å·¥ä½œæµï¼Œæ¯å¤©è‡ªåŠ¨æ£€æŸ¥å›ºå®šæ”¯å‡ºã€‚
**é…ç½®è¦æ±‚**: åœ¨ GitHub Repository Secrets ä¸­æ·»åŠ :
- `SUPABASE_URL`: ä½ çš„ Supabase URL
- `SUPABASE_KEY`: ä½ çš„ Supabase **Service Role** Key (è¿™æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºè‡ªåŠ¨åŒ–è„šæœ¬éœ€è¦ç»•è¿‡ RLS æ£€æŸ¥æ‰€æœ‰ç”¨æˆ·çš„è§„åˆ™)
```

### 2. Streamlit Dashboard (å‰ç«¯)
æœ¬åœ°è¿è¡Œæˆ–éƒ¨ç½²åˆ° Streamlit Cloudã€‚

```bash
pip install -r requirements.txt
streamlit run app.py
```

é…ç½®æ–‡ä»¶ `.streamlit/secrets.toml`:
```toml
[supabase]
url = "YOUR_SUPABASE_URL"
key = "YOUR_SUPABASE_ANON_KEY"

[general]
API_URL = "https://your-worker.workers.dev" # (å¯é€‰: å¦‚æœä½¿ç”¨ç‹¬ç«‹ Worker)
API_KEY = "your-key"
```

---

## ğŸ“ å¾…åŠè®¡åˆ’ (Roadmap)
- [x] **V3.0**: æœˆåº¦é¢„ç®—ç®¡ç† (Monthly Budgets)
- [x] **V3.0**: è‡ªåŠ¨å‘¨æœŸæ‰£æ¬¾ (Recurring Expenses)
- [ ] å¤šè´¦æˆ·/å¤šå¸ç§æ”¯æŒ
- [x] å¯¼å‡º Excel/CSV æŠ¥è¡¨ (å·²æ”¯æŒ CSV å¯¼å‡º)
- [ ] å¹´åº¦æ¶ˆè´¹æ·±åº¦åˆ†ææŠ¥å‘Š
